<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wordle Game</title>
    <link rel="icon" type="image/x-icon" href="hanzile_icon.png">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <button aria-label="Menu">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path fill="currentColor" d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path>
            </svg>
        </button>
        <h1>汉字le</h1>
        <div>
            <button aria-label="Statistics">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path fill="currentColor" d="M16 11V3H8v8H2v12h20V11h-6zm-6-6h4v14h-4V5zm-4 4h4v10H6V9zm12 10h-4V9h4v10z"></path>
                </svg>
            </button>
            <button aria-label="Settings">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path fill="currentColor" d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"></path>
                </svg>
            </button>
        </div>
    </header>

    <main class="game-container">
        <div class="board">
            <div class="row">
                <div class="tile" data-state="present">字</div>
                <div class="tile" data-state="absent">母</div>
            </div>
            <div class="row">
                <div class="tile" data-state="correct">汉</div>
                <div class="tile" data-state="correct">字</div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
            <div class="row">
                <div class="tile" data-state="empty"></div>
                <div class="tile" data-state="empty"></div>
            </div>
        </div>

        <main class="game-container">
            <div class="board">
                <!-- Your existing board content -->
            </div>

            <div class="keyboard" id="character-keyboard">
                <!-- This will be populated by JavaScript -->
            </div>
        </main>

        <script>
            const fallbackCharacters = ['的', '一', '是', '在', '不', '了', '有', '和', '人', '这', 
                                            '中', '大', '为', '上', '个', '国', '我', '以', '要', '他',
                                            '时', '来', '用', '们', '生', '到', '作', '地', '于', '出', '家'];
            
            // ['word', 'pinyin', 'definition'],
            const fallbackWords = [
                ['中国', 'zhōng guó', 'China'],
                ['我们', 'wǒ men', 'We/Us'],
                ['这个', 'zhè ge', 'This/These'],
                ['国家', 'guó jiā', 'Country/Home country']
            ]

            async function loadGame() {
                let words;

                try {
                    // Fetch the CSV file
                    const response = await fetch('words.csv');
                    const csvText = await response.text();
                    
                    // Parse CSV (simple parsing - assumes no commas in data)
                    const lines = csvText.trim().split('\n');
                    words = [];
                    
                    // Skip header row and process each line
                    for (let i = 1; i < lines.length; i++) {
                        const [index, word_hanzi, word_pinyin, word_def] = lines[i].split(',');
                        if (word_hanzi && word_hanzi.trim()) {
                            // Trim the row and put it in the words list
                            words.push([word_hanzi.trim(), word_pinyin.trim(), word_def.trim()]);
                        }
                    }
                } catch (error) {
                    console.error('Error loading character keyboard:', error);
                    // Fallback to a default set of characters if CSV fails to load
                    words = fallbackWords;
                }

                console.log(words)

                const i = Math.floor(Math.random() * words.length);
                const [word_hanzi, word_pinyin, word_def] = words[i]

                console.log(word_hanzi, word_pinyin, word_def)
            }

            // Function to load and parse the CSV file
            async function loadCharacterKeyboard() {
                try {
                    // Fetch the CSV file
                    const response = await fetch('characters.csv');
                    const csvText = await response.text();
                    
                    // Parse CSV (simple parsing - assumes no commas in data)
                    const lines = csvText.trim().split('\n');
                    const characters = [];
                    
                    // Skip header row and process each line
                    for (let i = 1; i < lines.length; i++) {
                        const [index, character] = lines[i].split(',');
                        if (character && character.trim()) {
                            characters.push(character.trim());
                        }
                    }
                    
                    // Generate keyboard layout
                    generateKeyboard(characters);
                    
                } catch (error) {
                    console.error('Error loading character keyboard:', error);
                    // Fallback to a default set of characters if CSV fails to load
                    generateKeyboard(fallbackCharacters);
                }
            }

            // Function to generate the keyboard layout
            function generateKeyboard(characters) {
                const keyboard = document.getElementById('character-keyboard');
                keyboard.innerHTML = '';
                
                // Determine how to split characters into rows
                // You can adjust these values based on your preferred layout
                const charsPerRow = 25;
                const rows = Math.ceil(characters.length / charsPerRow);
                
                // Create keyboard rows
                for (let row = 0; row < rows; row++) {
                    const rowDiv = document.createElement('div');
                    rowDiv.className = 'keyboard-row';
                    
                    // Get characters for this row
                    const startIndex = row * charsPerRow;
                    const endIndex = Math.min(startIndex + charsPerRow, characters.length);
                    const rowCharacters = characters.slice(startIndex, endIndex);
                    
                    // Create keys for each character in this row
                    rowCharacters.forEach(char => {
                        const keyButton = document.createElement('button');
                        keyButton.className = 'key';
                        keyButton.textContent = char;
                        keyButton.setAttribute('data-key', char);
                        keyButton.setAttribute('aria-label', `Character ${char}`);
                        
                        // Add click event handler
                        keyButton.addEventListener('click', () => {
                            handleCharacterInput(char);
                        });
                        
                        rowDiv.appendChild(keyButton);
                    });
                    
                    keyboard.appendChild(rowDiv);
                }
                
                // Add special function keys row (Enter, Backspace, etc.)
                const functionRow = document.createElement('div');
                functionRow.className = 'keyboard-row';
                
                // Enter key
                const enterKey = document.createElement('button');
                enterKey.className = 'key wide';
                enterKey.textContent = 'Enter';
                enterKey.setAttribute('data-key', 'enter');
                enterKey.addEventListener('click', handleEnter);
                functionRow.appendChild(enterKey);
                
                // Backspace key
                const backspaceKey = document.createElement('button');
                backspaceKey.className = 'key wide';
                backspaceKey.innerHTML = `
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path fill="currentColor" d="M22 3H7c-.69 0-1.23.35-1.59.88L0 12l5.41 8.11c.36.53.9.89 1.59.89h15c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H7.07L2.4 12l4.66-7H22v14zm-11.59-2L14 13.41 17.59 17 19 15.59 15.41 12 19 8.41 17.59 7 14 10.59 10.41 7 9 8.41 12.59 12 9 15.59z"></path>
                    </svg>
                `;
                backspaceKey.setAttribute('data-key', 'backspace');
                backspaceKey.addEventListener('click', handleBackspace);
                functionRow.appendChild(backspaceKey);
                
                keyboard.appendChild(functionRow);
            }

            // Character input handler
            function handleCharacterInput(character) {
                console.log('Character pressed:', character);
                // Add your game logic here to handle character input
                // For example: add the character to the current active tile
            }

            // Enter key handler
            function handleEnter() {
                console.log('Enter pressed');
                // Add your game logic here to handle Enter key
                // For example: submit the current guess
            }

            // Backspace key handler
            function handleBackspace() {
                console.log('Backspace pressed');
                // Add your game logic here to handle Backspace
                // For example: remove the last character from the current guess
            }

            // Initialize the keyboard when the page loads
            document.addEventListener('DOMContentLoaded', loadGame);
            document.addEventListener('DOMContentLoaded', loadCharacterKeyboard);
        </script>
    </main>

</body>
</html>